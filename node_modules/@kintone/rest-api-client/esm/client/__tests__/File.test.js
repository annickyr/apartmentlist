import { MockClient } from "../../http/MockClient";
import { FileClient } from "../FileClient";
import FormData from "form-data";
jest.mock("form-data");
describe("FileClient", function () {
    var mockClient;
    var fileClient;
    beforeEach(function () {
        mockClient = new MockClient();
        fileClient = new FileClient(mockClient);
    });
    describe("uploadFile", function () {
        var params = {
            file: {
                name: "text.text",
                data: "Hello!"
            }
        };
        beforeEach(function () {
            fileClient.uploadFile(params);
        });
        it("should pass the path to the http client", function () {
            expect(mockClient.getLogs()[0].path).toBe("/k/v1/file.json");
        });
        it("should send a post request", function () {
            expect(mockClient.getLogs()[0].method).toBe("post");
        });
        it("should pass file object includes name and data as a param to the http client", function () {
            var MockFormData = FormData;
            expect(MockFormData.prototype.append.mock.calls[0]).toEqual([
                "file",
                params.file.data,
                params.file.name
            ]);
        });
    });
    describe("downloadFile", function () {
        var params = { fileKey: "some_file_key" };
        beforeEach(function () {
            fileClient.downloadFile(params);
        });
        it("should pass the path to the http client", function () {
            expect(mockClient.getLogs()[0].path).toBe("/k/v1/file.json");
        });
        it("should send a get request", function () {
            expect(mockClient.getLogs()[0].method).toBe("get");
        });
        it("should pass fileKey as a param to the http client", function () {
            expect(mockClient.getLogs()[0].params).toEqual(params);
        });
    });
});
describe("FileClient with guestSpaceId", function () {
    var GUEST_SPACE_ID = 1;
    var params = {
        file: {
            name: "text.text",
            data: "Hello!"
        }
    };
    var mockClient = new MockClient();
    var fileClient = new FileClient(mockClient, GUEST_SPACE_ID);
    fileClient.uploadFile(params);
    it("should pass the path to the http client", function () {
        expect(mockClient.getLogs()[0].path).toBe("/k/guest/" + GUEST_SPACE_ID + "/v1/file.json");
    });
});
